---
layout: "layouts/base.njk"
---

<div class="random-grid-container">
  {% if title %}
  <h1 class="page-title">{{ title }}</h1>
  {% endif %}

  {% if subtitle %}
  <p class="page-subtitle">{{ subtitle }}</p>
  {% endif %}

  <div class="random-grid">
    {% for project in globokarProjects %}
      <a href="/projects/research/globokar-oliveros/{{ project.id }}" class="grid-item" data-index="{{ loop.index0 }}">
        <div class="item-inner" style="background-image: url('{{ project.pictureUrl }}');">
          <div class="item-overlay"></div>
          <span class="item-title">{{ project.name }}</span>
        </div>
      </a>
    {% endfor %}
  </div>
</div>

<script>
  // Client-side randomization on every page load
  (function() {
    const container = document.querySelector('.random-grid');
    if (!container) return;

    const items = Array.from(container.querySelectorAll('.grid-item'));

    // Fisher-Yates shuffle algorithm
    function shuffle(array) {
      const shuffled = [...array];
      for (let i = shuffled.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
      }
      return shuffled;
    }

    // Random integer between min and max (inclusive)
    function randomInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    // Choose a random layout variant (1-3)
    const layoutVariant = randomInt(1, 3);
    container.classList.add(`layout-variant-${layoutVariant}`);

    // Assign random sizes and shapes to each item
    items.forEach(item => {
      const sizeVariant = randomInt(1, 4);
      const shapeVariant = randomInt(1, 3);
      item.classList.add(`size-${sizeVariant}`, `shape-${shapeVariant}`);
    });

    // Shuffle and re-append items
    const shuffledItems = shuffle(items);
    shuffledItems.forEach(item => container.appendChild(item));
  })();
</script>

<style>
  .random-grid-container {
    padding: var(--size-xl) var(--size-m);
    min-height: 90vh;
  }

  .page-title {
    text-align: center;
    margin-bottom: var(--size-m);
    font-weight: normal;
    font-size: 2.5rem;
  }

  .page-subtitle {
    text-align: center;
    max-width: 800px;
    margin: 0 auto var(--size-xl);
    color: var(--color-text-light);
    line-height: 1.6;
  }

  .random-grid {
    display: grid;
    gap: 1.5rem;
    max-width: 1400px;
    margin: 0 auto;
  }

  /* Layout Variant 1: Asymmetric Masonry */
  .layout-variant-1 {
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    grid-auto-rows: 200px;
  }

  /* Layout Variant 2: Scattered */
  .layout-variant-2 {
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    grid-auto-rows: 180px;
  }

  /* Layout Variant 3: Dense Grid */
  .layout-variant-3 {
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    grid-auto-rows: 220px;
  }

  .grid-item {
    position: relative;
    overflow: hidden;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    border: 1px solid var(--color-border);
  }

  .grid-item:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.6);
    z-index: 10;
  }

  /* Size variations */
  .size-1 { grid-row: span 1; grid-column: span 1; }
  .size-2 { grid-row: span 1; grid-column: span 2; }
  .size-3 { grid-row: span 2; grid-column: span 1; }
  .size-4 { grid-row: span 2; grid-column: span 2; }

  /* Shape variations */
  .shape-1 { border-radius: 0; }
  .shape-2 { border-radius: 12px; }
  .shape-3 { border-radius: 50%; }

  .item-inner {
    width: 100%;
    height: 100%;
    background-size: cover;
    background-position: center;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    background-color: #1a1a1a;
  }

  .item-overlay {
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.5);
    transition: background 0.3s;
  }

  .grid-item:hover .item-overlay {
    background: rgba(0,0,0,0.7);
  }

  .item-title {
    position: relative;
    z-index: 2;
    color: white;
    font-size: 1rem;
    text-align: center;
    padding: 1rem;
    text-shadow: 0 2px 8px rgba(0, 0, 0, 0.8), 0 0 20px rgba(0, 0, 0, 0.5);
    font-weight: 500;
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    .random-grid {
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)) !important;
      grid-auto-rows: 150px !important;
      gap: 1rem;
    }

    .page-title {
      font-size: 2rem;
    }

    /* Simplify sizes on mobile */
    .size-2, .size-3, .size-4 {
      grid-row: span 1;
      grid-column: span 1;
    }

    /* Only use subtle rounding on mobile */
    .shape-3 { border-radius: 12px; }
  }

  @media (max-width: 480px) {
    .random-grid {
      grid-template-columns: repeat(2, 1fr) !important;
    }

    .page-title {
      font-size: 1.5rem;
    }

    .item-title {
      font-size: 0.85rem;
      padding: 0.5rem;
    }
  }
</style>
